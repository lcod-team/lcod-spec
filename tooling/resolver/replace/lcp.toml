schemaVersion = "2.0"
id = "lcod://tooling/resolver/replace/apply@0.1.0"
version = "0.1.0"
kind = "function"
summary = "Compute the final component id after applying resolver replacement rules."

[deps]
requires = [
  "lcod://flow/break@1",
  "lcod://flow/foreach@1",
  "lcod://flow/if@1",
  "lcod://impl/set@1",
  "lcod://tooling/array/append@0.1.0",
  "lcod://tooling/value/clone@0.1.0",
  "lcod://tooling/value/default_array@0.1.0",
  "lcod://tooling/value/default_object@0.1.0",
  "lcod://tooling/value/is_object@0.1.0",
  "lcod://tooling/value/is_string_nonempty@0.1.0",
  "lcod://contract/core/object/get@1",
  "lcod://contract/core/string/format@1",
  "lcod://contract/core/value/equals@1",
]

[tool]
name = "Resolver Replace Apply"
description = "Traverses alias/spec replacement maps to determine the effective component id and optional override spec, reporting cycles as warnings."
inputSchema = "schema/apply.in.json"
outputSchema = "schema/apply.out.json"

[inputs.visited]
summary = "Internal recursion guard; callers should omit."
required = false
schema = """
{
  "type": "array",
  "items": { "type": "string" }
}"""

[documentation]
body = """
Utility component that resolves the effective component identifier according to the resolver configuration:

- walks the `replaceAlias` map until it finds a terminal id or encounters a cycle;
- if a specific override is present in `replaceSpec`, returns it alongside the resolved id;
- reports misconfigurations (missing id, alias cycles) through the accumulated warnings.

This helper keeps the replacement logic reusable across resolver flows and easy to unit test."""
