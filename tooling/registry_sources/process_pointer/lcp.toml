schemaVersion = "2.0"
id = "lcod://tooling/registry_sources/process_pointer@0.1.0"
version = "0.1.0"
kind = "component"
summary = "Resolve a registry pointer entry and emit catalogue lines or nested pointers."

[palette]
category = "Registry"
icon = "mdi:source-branch"
tags = [ "registry", "catalogue", "pointer" ]

[deps]
requires = [
  "lcod://tooling/script@1",
  "lcod://contract/core/fs/read-file@1",
  "lcod://contract/core/git/clone@1",
  "lcod://axiom/http/download@1",
  "lcod://tooling/path/join_chain@0.1.0",
  "lcod://tooling/path/dirname@0.1.0",
  "lcod://tooling/path/is_absolute@0.1.0",
  "lcod://tooling/hash/sha256_base64@0.1.0",
  "lcod://tooling/registry_sources/normalize_pointer@0.1.0",
  "lcod://tooling/registry_sources/process_catalogue@0.1.0",
  "lcod://tooling/value/is_string_nonempty@0.1.0",
  "lcod://tooling/jsonl/read@0.1.0"
]

[inputs.pointer]
summary = "Pointer descriptor being processed."
required = true
schema = """
{
  "type": "object"
}"""

[inputs.downloadsRoot]
summary = "Filesystem root for cached downloads."
required = false
schema = """
{
  "type": "string"
}"""

[inputs.defaultEntrypoint]
summary = "Fallback entrypoint definition inherited from parent lists."
required = false
schema = """
{
  "type": "object"
}"""

[inputs.basePriority]
summary = "Priority inherited from parent lists."
required = false
schema = """
{
  "type": "integer"
}"""

[outputs.entry]
summary = "Inline registry entry describing resolved catalogue lines."
schema = """
{
  "type": ["object", "null"]
}"""

[outputs.children]
summary = "Normalized child pointers produced while processing the catalogue."
schema = """
{
  "type": "array"
}"""

[outputs.warnings]
summary = "Warnings emitted while resolving the pointer."
schema = """
{
  "type": "array"
}"""

[outputs.commit]
summary = "Resolved commit hash associated with the pointer source."
schema = """
{
  "type": ["string", "null"]
}"""

[outputs.slots]
summary = "Child pointer slots to enqueue for further resolution."
schema = """
{
  "type": "array"
}"""

[documentation]
body = """
Resolves a registry pointer (file, HTTP, or git reference), loads the referenced manifest, and emits either inline catalogue lines or new child pointers. The component also downloads remote manifests to a cache directory, keeps track of provenance metadata, and surfaces warnings when payloads are malformed.
"""
