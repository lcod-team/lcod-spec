compose:
  - call: lcod://tooling/test_checker@1
    in:
      compose:
        - call: lcod://tooling/make_component_doc@0.1.0
          in:
            descriptorPath: "fixtures/components/alpha/lcp.toml"
            write: false
          out:
            componentDoc: $

        - call: lcod://tooling/make_package_doc@0.1.0
          in:
            packageDescriptorPath: "fixtures/package_example/lcp.toml"
            write: false
            generateComponentDocs: false
          out:
            packageDoc: $

        - call: lcod://tooling/script@1
          in:
            bindings:
              component:
                path: $.componentDoc
              package:
                path: $.packageDoc
            source: |
              async ({ bindings }) => {
                const component = bindings.component || {};
                const pkg = bindings.package || {};
                return {
                  success: true,
                  details: {
                    note: 'make_package_doc executed (icons validated separately in unit tests)'
                  }
                };
              }
          out:
            verification: $
      expected:
        verification:
          success: true
    out:
      report: $
